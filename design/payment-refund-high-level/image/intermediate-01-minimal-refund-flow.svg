<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="560" viewBox="0 0 1400 560">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#374151" />
    </marker>
    <style>
      .title { font: 700 28px Arial, Helvetica, sans-serif; fill: #0f172a; }
      .node { fill: #eef2ff; stroke: #3730a3; stroke-width: 2; rx: 12; ry: 12; }
      .db { fill: #ecfeff; stroke: #0f766e; stroke-width: 2; rx: 12; ry: 12; }
      .ext { fill: #fff7ed; stroke: #c2410c; stroke-width: 2; rx: 12; ry: 12; }
      .label { font: 600 18px Arial, Helvetica, sans-serif; fill: #111827; text-anchor: middle; dominant-baseline: middle; }
      .line { stroke: #374151; stroke-width: 2.5; fill: none; marker-end: url(#arrow); }
      .note { font: 500 15px Arial, Helvetica, sans-serif; fill: #4b5563; }
    </style>
  </defs>

  <text x="700" y="50" class="title" text-anchor="middle">Intermediate Design 1: Minimal Refund Flow (Synchronous)</text>

  <rect class="node" x="80" y="220" width="220" height="90" />
  <text class="label" x="190" y="265">Merchant Client</text>

  <rect class="node" x="380" y="220" width="220" height="90" />
  <text class="label" x="490" y="265">API Gateway</text>

  <rect class="node" x="680" y="220" width="220" height="90" />
  <text class="label" x="790" y="265">Refund Service</text>

  <rect class="db" x="980" y="120" width="280" height="90" />
  <text class="label" x="1120" y="165">Payments and Refunds DB</text>

  <rect class="ext" x="980" y="320" width="280" height="90" />
  <text class="label" x="1120" y="365">Payment Provider</text>

  <line class="line" x1="300" y1="265" x2="380" y2="265" />
  <line class="line" x1="600" y1="265" x2="680" y2="265" />

  <line class="line" x1="900" y1="240" x2="980" y2="190" />
  <line class="line" x1="900" y1="290" x2="980" y2="355" />
  <line class="line" x1="980" y1="335" x2="900" y2="280" />

  <path class="line" d="M 760 310 C 620 430, 360 430, 220 310" />

  <text class="note" x="955" y="210">persist refund state</text>
  <text class="note" x="955" y="335">provider refund call</text>
  <text class="note" x="560" y="460">response returned after provider round trip</text>
</svg>
